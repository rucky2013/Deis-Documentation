备份和还原数据
------------


尽管部署在Deis上的应用因遵循12因子的方法学而无状态，Deis却需要在存储（Store）部件维护着平台的状态。

存储部件运行着Ceph，数据库组件（Database）,注册表组件（Registry）,控制器组件（Controller）和日志组件（Logger）都需要把存储组件（Store）当做一个数据存储来使用。数据库组件和注册表组件使用存储网关（store-gateway）,控制器和日志组件使用存储卷（store-volume）。这些组件有了存储组件作为后备，可以自由的在集群上移动，因为他们的状态有存储组件做后备。

假如一个主机失效然后重新加入集群，根据配置存储组件仍然会以降级的状态运作，并且会自动的恢复。Ceph的数据完全丢失只可能发生在所有的存储容器被移除的情形下。然而，备份Ceph相当直接简单，我们建议在升级Deis之前进行备份。



存放在Ceph中的数据可以通过两个地方访问到：在CoreOS文件系统的/var/lib/deis/store下，和存储网关组件（store-gateway）。备份此份数据也比较简单，我们可以把该文件系统的数据做一个tar包，然后使用任何S3兼容的blob存储工具将存储网关所有的文件下载下来。
